server:
  port: 8090

spring:
  application:
    name: rdx-loghealer

  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5434}/${DB_NAME:rdx_loghealer_db}
    username: ${DB_USER:loghealer}
    password: ${DB_PASSWORD:loghealer123}
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000

  jpa:
    hibernate:
      ddl-auto: validate
    open-in-view: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
    show-sql: false

  liquibase:
    change-log: classpath:db/changelog/db.changelog-master.xml
    enabled: true

  elasticsearch:
    uris: ${ELASTICSEARCH_URI:http://localhost:9200}
    username: ${ELASTICSEARCH_USERNAME:}
    password: ${ELASTICSEARCH_PASSWORD:}
    connection-timeout: 5s
    socket-timeout: 30s

  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6381}
      password: ${REDIS_PASSWORD:}

  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${JWT_ISSUER_URI:https://auth.reddia-x.com}
          jwk-set-uri: ${JWK_SET_URI:https://auth.reddia-x.com/oauth2/jwks}

logging:
  level:
    root: INFO
    com.reddiax.loghealer: DEBUG
    org.springframework.data.elasticsearch: DEBUG

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: when_authorized

springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html
    enabled: true

loghealer:
  ingestion:
    batch-size: 1000
    flush-interval-ms: 5000
  elasticsearch:
    log-index-prefix: logs
    exception-index: exception-groups
    default-retention-days: 90
  ai:
    default-provider: claude
    claude:
      api-key: ${CLAUDE_API_KEY:}
      model: claude-sonnet-4-20250514
    openai:
      api-key: ${OPENAI_API_KEY:}
      model: gpt-4o
